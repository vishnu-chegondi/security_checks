{% extends "base.html" %}
<!-- Add main content here -->
{% block heading %}
<h2 class="text-2xl leading-6 font-small text-gray-700">
    AWS Fundamental Security Checks
</h2>
{% endblock %}
{% block content %}


<table class="table-auto w-full mt-10 border-gray-200 rounded-sm shadow-lg border-collapse">
    <thead class="h-15 p-2 bg-white rounded-sm">
    <tr class="border-b border-gray-200 rounded-sm text-gray-600 bg-[#fff] text-sm">
        <th>Account ID</th>
        <th>Check</th>
        <th>Description</th>
        <th>Failed Count</th>
        <th>Total Instances</th>
        <th>Details</th>
    </tr>
    </thead>
    <tbody>
    {% for check in checks %}
    <tr class="border-b border-gray-200 text-center text-gray-500">
        <td class="p-2">{{ aws_account_id }}</td>
        <td class="p-2">{{ check["name"] }}</td>
        <td class="p-2">{{ check["description"] }}</td>
        <td class="p-2">{{ check["imdsv1_count"] }}</td>
        <td class="p-2">{{ check["total_count"] }}</td>
        <td class="p-2">
            <a href="/aws/ec2/imdsv1/{{ aws_account_id }}" class="text-blue-400">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5 inline"
                     title="details">
                    <path fill-rule="evenodd"
                          d="M.99 5.24A2.25 2.25 0 0 1 3.25 3h13.5A2.25 2.25 0 0 1 19 5.25l.01 9.5A2.25 2.25 0 0 1 16.76 17H3.26A2.267 2.267 0 0 1 1 14.74l-.01-9.5Zm8.26 9.52v-.625a.75.75 0 0 0-.75-.75H3.25a.75.75 0 0 0-.75.75v.615c0 .414.336.75.75.75h5.373a.75.75 0 0 0 .627-.74Zm1.5 0a.75.75 0 0 0 .627.74h5.373a.75.75 0 0 0 .75-.75v-.615a.75.75 0 0 0-.75-.75H11.5a.75.75 0 0 0-.75.75v.625Zm6.75-3.63v-.625a.75.75 0 0 0-.75-.75H11.5a.75.75 0 0 0-.75.75v.625c0 .414.336.75.75.75h5.25a.75.75 0 0 0 .75-.75Zm-8.25 0v-.625a.75.75 0 0 0-.75-.75H3.25a.75.75 0 0 0-.75.75v.625c0 .414.336.75.75.75H8.5a.75.75 0 0 0 .75-.75ZM17.5 7.5v-.625a.75.75 0 0 0-.75-.75H11.5a.75.75 0 0 0-.75.75V7.5c0 .414.336.75.75.75h5.25a.75.75 0 0 0 .75-.75Zm-8.25 0v-.625a.75.75 0 0 0-.75-.75H3.25a.75.75 0 0 0-.75.75V7.5c0 .414.336.75.75.75H8.5a.75.75 0 0 0 .75-.75Z"
                          clip-rule="evenodd"/>
                </svg>
            </a>
        </td>
    </tr>
    {% endfor %}
    </tbody>
</table>

{% endblock %}